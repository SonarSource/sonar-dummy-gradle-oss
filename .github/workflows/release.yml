name: release

on:
  release:
    types:
      - published

jobs:
  release:
    name: Release
    uses: SonarSource/gh-action_release/.github/workflows/release-publish.yml@task/dav/build-1184-releasability
    secrets:
      artifactory-api-key: ${{ secrets.ARTIFACTORY_API_KEY }}
      release-github-token: ${{ secrets.RELEASE_GITHUB_TOKEN }}
      slack-api-token: ${{ secrets.SLACK_API_TOKEN }}
      binaries-api-deploy: ${{ secrets.BINARIES_AWS_DEPLOY }}
      binaries-aws-access-key-id: ${{ secrets.BINARIES_AWS_ACCESS_KEY_ID }}
      binaries-aws-secret-access-key: ${{ secrets.BINARIES_AWS_SECRET_ACCESS_KEY }}
      binaries-aws-region: ${{ secrets.BINARIES_AWS_REGION }}
      releasability-aws-access-key-id: ${{ secrets.RELEASABILITY_AWS_ACCESS_KEY_ID }}
      releasability-aws-secret-access-key: ${{ secrets.RELEASABILITY_AWS_SECRET_ACCESS_KEY }}
    env:
      RELEASABILITY_ENV_TYPE: Dev
  maven-central-sync:
    needs:
      - release
    name: Maven Central Sync
    uses: SonarSource/gh-action_release/.github/workflows/maven-central-sync.yml@task/dav/build-1184-releasability
    secrets:
      artifactory-cli-config-public-reader: ${{ secrets.REPOX_CLI_CONFIG_PUBLIC_READER }}
      sonatype-oss-hosting-username: ${{ secrets.OSSRH_USERNAME }}
      sonatype-oss-hosting-password: ${{ secrets.OSSRH_PASSWORD }}
      slack-build-webhook-url: ${{ secrets.SLACK_BUILD_WEBHOOK }}
